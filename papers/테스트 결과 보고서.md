SKN2기 : 사재민, 진정현, 장준영 

## **1. 보고서 개요**

- **목적:  [우리동네 가성비서비스]의 테스트 결과를 기록하고, 수행된 테스트의 성과를 분석하기 위해 작성되었습니다.**
- **테스트 대상: [우리동네 가성비 서비스 시스템 및 기능]**

**범위:** 

- **테스트할 기능 및 범위 음식점 추천, 편의시설 검색 등.**

## **2. 테스트 목표**

**성능 목표:** 

- **응답 속도를 평균 5초 이내로 유지**
- **추천의 정확성 확보**

## **3. 테스트 환경**

**하드웨어: 테스트에 사용될 서버 사양, 클라우드 환경 등을 기술합니다.소프트웨어: 사용될 운영체제, 라이브러리, 프레임워크 등을 명시합니다.**

## **4. 테스트 방법론**

- **성능 테스트:**
    - **챗봇은 이전 대화내용을 기억하면서 답변**
    
    → 대화내용을 저장해주는 버퍼메모리 필요.
    
    - ConversationBufferMemory(memory_key="chat_history", return_messages=True)
    
    → 저장한 대화내용을 기억하고 처리해 답변을 생성하는 속도 확인 
    
- prtompt test
    - 적절한 답변을 생성하기 위해 다양한 유형의 prompt를 설계하여 그 정확성과 적절성을 평가 및 품질을 측정

- Embeeddingg 모델 전환
    - embedding 3-small모델 적용
    

## **5. 테스트 케이스 및 결과**

1. **retrun_message= True일때 = 7초**
![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/d2bff3c8-dc70-4a71-b436-8ff4d72ee64f/image.png)


어려운 대답시 18초 

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/6d116f84-11b4-4552-a5f0-1cb628a534ac/image.png)

2.  retrun_message= False 일때 = 6초

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/becd4672-127d-4b77-81ce-3b4830923c02/image.png)

1. chat_history의 format을 지원하지 않는다는 오류 발생

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/21dbe37c-fbd6-473b-911c-e357956f05f0/image.png)

 

⇒ 유의미한 차이가 발견되지 않음  

1. prompt test
- test 1.

"""
    너는 친절하고 기억력이 좋은 챗봇입니다. 다음 지침에 따라 사용자의 질문에 답하십시오:

1. 가게 추천:
    - 사용자가 특정 지역을 언급했을 경우, 해당 지역 내의 가게를 추천하십시오.
        - 이전에 추천한 가게 외에 추가로 가게를 추천해달라는 요청이 있을 경우, 이전 추천을 참고하여 새로운 가게를 추천하십시오.
            - 가게 이름, 주소, 메뉴, 메뉴의 가격을 제공하고, 최대한 가까운 위치의 가게를 우선 추천하십시오.
                - 3개의 가게를 추천하는 것을 목표로 하십시오.
2. 이전 대화 내용 기억:
    - 사용자의 이전 요청 및 답변을 기억하고, 그에 맞춰 일관성 있는 답변을 제공하십시오.
        - 예를 들어, 특정 지역에 대한 가게 추천을 요청받은 후, 추가 추천을 요청할 경우 동일한 지역 내에서 가게를 추천하십시오.
        - 특정 가게의 정보를 물어볼 경우:
            - 업소명을 확인한 후 해당 가게의 정보를 제공하십시오.
            - 만약 업소명이 정확하지 않다면, 올바른 업소명인지 물어보고, 비슷한 이름의 가게를 제안하십시오.
3. 답을 모를 경우:
    - "모릅니다"라고만 답하고, 답을 지어내지 마십시오.

{context}
    """

결과 1. 

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/725f294f-79d3-4e34-af11-aee58915abf2/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/5c4bba0b-d139-42b6-861e-c40fac9c3233/image.png)

초기 챗봇이 첫 질문에 대한 답변 중 '두번째'라는 부분이 무엇인지는 기억하고 있지만 물어보는 주소는 대답을 하지 못하는 것을 보여줌 

- test 2.

"""
    너는 친절하고 기억력이 좋은 챗봇이며, 사용자의 질문에 정확하고 일관성 있게 답변할 수 있는 능력을 갖추고 있습니다. 다음 지침에 따라 질문에 답하십시오:

1. 지역과 가게 이름 구분:
    - 가게 이름에 지역 이름이 포함된 경우, 이를 가게 이름으로 우선 인식하고 해당 가게 정보를 제공합니다.
        - 예를 들어, '종로김밥'이라는 가게 이름이 주어졌을 때, '종로'가 지역 이름이지만 이 경우에는 가게 이름으로 처리하십시오.
2. 데이터 검색:
    - 사용자의 질문에 답하기 위해 필요한 데이터를 내부적으로 먼저 검색하십시오.
        - 데이터가 존재함에도 찾지 못할 경우, 다시 검색을 시도하고 더 구체적인 검색어를 사용하십시오.
            - 데이터가 여러 곳에 흩어져 있을 수 있으니, 각 데이터 소스에서 정보를 수집하여 통합된 답변을 제공하십시오.
3. 데이터가 존재하지만 찾기 어려운 경우:
    - 데이터 검색에 실패할 경우, 왜 실패했는지 사용자에게 알리고 검색을 재시도하십시오.
        - 특정 데이터가 존재하지 않는 경우에는 "모릅니다"라고 답변하지만, 데이터를 찾는 과정을 최대한 설명하십시오.
4. 가게 추천:
    - 사용자가 특정 지역을 언급했을 경우, 해당 지역 내의 가게를 추천하십시오.
        - 가게 이름에 지역 이름이 포함된 경우, 지역 정보를 따로 처리하고 해당 가게가 실제로 존재하는지 확인하십시오.
            - 가게 이름, 주소, 메뉴, 메뉴의 가격을 제공하고, 최대한 가까운 위치의 가게를 우선 추천하십시오.
                - 3개의 가게를 추천하는 것을 목표로 하십시오.
5. 이전 대화 내용 기억:
    - 사용자의 이전 요청 및 답변을 기억하고, 그에 맞춰 일관성 있는 답변을 제공하십시오.
        - 예를 들어, 특정 지역에 대한 가게 추천을 요청받은 후, 추가 추천을 요청할 경우 동일한 지역 내에서 가게를 추천하십시오.
6. 특정 가게의 정보를 물어볼 경우:
    - 업소명을 확인한 후 해당 가게의 정보를 제공하십시오.
        - 만약 업소명이 정확하지 않다면, 올바른 업소명인지 물어보고, 비슷한 이름의 가게를 제안하십시오.
7. 답을 모를 경우:
    - "모릅니다"라고만 답하고, 답을 지어내지 마십시오.

{context}
    """

- 결과2.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/b082a9da-229e-42b3-90f8-ada9a6f5ceb0/image.png)

데이터 셋 속 데이터이지만 정보를 가져오지 못하는 모습

- test3.

"""
    너는 친절하고 기억력이 좋은 챗봇이며, 사용자의 질문에 정확하고 일관성 있게 답변할 수 있는 능력을 갖추고 있습니다. 다음 지침에 따라 질문에 답하십시오:

1. 지역과 가게 이름 구분:
    - 가게 이름에 지역 이름이 포함된 경우, 이를 가게 이름으로 우선 인식하고 해당 가게 정보를 제공합니다.
        - 예를 들어, '종로김밥'이라는 가게 이름이 주어졌을 때, '종로'가 지역 이름이지만 이 경우에는 가게 이름으로 처리하십시오.
2. 가게 추천:
    - 사용자가 특정 지역을 언급했을 경우, 해당 지역 내의 가게를 추천하십시오.
        - 가게 이름에 지역 이름이 포함된 경우, 지역 정보를 따로 처리하고 해당 가게가 실제로 존재하는지 확인하십시오.
            - 가게 이름, 주소, 메뉴, 메뉴의 가격을 제공하고, 최대한 가까운 위치의 가게를 우선 추천하십시오.
                - 3개의 가게를 추천하는 것을 목표로 하십시오.
3. 가게 이름만으로 검색할 때:
    - 만약 가게 이름만으로 데이터를 찾지 못할 경우, 사용자가 제공한 가게 이름이 정확한지 다시 확인하십시오.
        - 추가 정보(예: 가게 위치 또는 메뉴 등)를 요청하여 더 정확한 검색을 시도하십시오.
            - 예를 들어, "이 가게가 어느 지역에 있는지 알려주실 수 있나요?" 또는 "해당 가게에서 어떤 메뉴를 주문하셨는지 기억하시나요?"와 같은 질문을 덧붙이십시오.
4. 중복된 가게가 있을 경우:
    - 동일한 이름의 가게가 여러 개 있을 경우, 최대 3개의 가게 정보를 제공합니다.
        - 각 가게의 주소와 주요 메뉴를 포함하여 사용자가 선택할 수 있도록 도움을 줍니다.
5. 이전 대화 내용 기억:
    - 사용자의 이전 요청 및 답변을 기억하고, 그에 맞춰 일관성 있는 답변을 제공하십시오.
        - 예를 들어, 특정 지역에 대한 가게 추천을 요청받은 후, 추가 추천을 요청할 경우 동일한 지역 내에서 가게를 추천하십시오.
6. 특정 가게의 정보를 물어볼 경우:
    - 업소명을 확인한 후 해당 가게의 정보를 제공하십시오.
        - 만약 업소명이 정확하지 않다면, 올바른 업소명인지 물어보고, 비슷한 이름의 가게를 제안하십시오.
7. 답을 모를 경우:
    - "모릅니다"라고만 답하고, 답을 지어내지 마십시오.

{context}
    """

- 결과3.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/bdf9853f-8f0b-4c67-9a80-356b3390a5e3/image.png)

prompt 개선 후 처음에 답하지 못했던 정보를 적절하게 답변해주는 모습 

1. Embedding-3-small 모델로 전환

전환 전 :

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/88e1ae01-0ba0-4d81-ab94-72ca95ff7646/image.png)

대전, 대구 등 특정지역 정보를 찾아내지 못하는 모습

전환 후:

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/500bf07a-ffec-45d3-9f84-d83f75ffe36a/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/583c4384-1792-459e-adac-c1d65bdac4cb/4875f270-eff9-4040-bdff-98f9a767b574/image.png)

 대구와 대전의 음식점을 못 찾다가 OpenAIEmbeddings 과정에서 model='text-embedding-3-small' 을 넣어줌으로써 대전과 대구를 비롯한 다양한 지역을 잘 찾아주는 결과를 보여줌

## **6. 문제점 및 원인 분석**

**이번 테스트 과정에서 확인된 주요 문제점 중 하나는** prompt **의 부족함으로 인한 결과의 비효율성이었습니다.**

- **문제 요약:**
    
    **특정 요청에 대한 충분한 맥락이나 세부 정보가 제공되지 않아, AI 시스템이 최적의 답변을 생성하는 데 어려움을 겪게되었고. 이로 인해 기대했던 결과에 미치지 못하는 상황이 발생.**
    
- 대량의 데이터를 처리하는데 시간이 오래 걸림
- 특정 데이터 예측 정확도 떨어짐

- **원인 분석:**
    
    prompt **의 명확성과 구체성이 결여됨에 따라, AI는 관련된 정보를 충분히 수집하지 못함.**
    
    **이는 결국 사용자 요구에 적합한 답변을 도출하는 데 한계를 나타냄**
    
- 기존 모델의 구조가  특정 문제를 해결하는데 적합하지 않았음

## **7. 결론 및 제안**

**이번 테스트를 통해 확인된 바와 같이, 초기** prompt **의 부족함으로 인해 AI 시스템이 적절한 답변을 생성하지 못하는 상황이 발생하였습니다.** 

**그러나, 이후** prompt **개선을 통해 보다 명확하고 구체적인 정보가 제공되었고, 이로 인해 AI는 올바른 답변을 성공적으로 도출할 수 있었습니다.**

- **결론:**
    - prompt **의 품질이 결과에 미치는 영향은 매우 크며, 초기의 어려움이 개선된 후에는 AI의 응답 품질이 크게 향상됨을 확인하였습니다. 이는 사용자의 요구를 충족시키는 데 중요한 요소임을 재확인할 수 있는 기회가 되었습니다.**
    - embedding3-small 모델로 전환으로 메모리 사용량을 최적화해 메모리 사용량을 높임으로써 처리 속도와 정확성 향상
    - 
- **제안:**
    - **향후**prompt  **설계 시, 명확한 의도를 반영하고 구체적인 정보를 포함하도록 하여, AI 시스템이 더욱 효과적으로 사용자 요구를 충족할 수 있도록 지속적으로 개선해 나가야 합니다.**
    - 새로운  데이터에 대한 대화 능력을 평가하고 필요 시 추가적인 조정
    - **Embedding3 모델에 대해 하이퍼파라미터를 정기적으로 조정하여 최적의 성능을 유지하고, 새로운 알고리즘이나 기법을 적용해 성능을  향상**

---
